---

title: PiPeline


keywords: fastai
sidebar: home_sidebar

summary: "example of ML pipeline."
description: "example of ML pipeline."
nb_path: "index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This file will become your README and also the index of your documentation.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Install">Install<a class="anchor-link" href="#Install"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><code>pip install PipelineMLNbdev</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="How-to-use">How to use<a class="anchor-link" href="#How-to-use"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Fill me in please! Don't forget code examples:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">get_data</span><span class="p">(</span><span class="s2">&quot;data/new_maisons-nan.csv&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>surface</th>
      <th>nb_chambre</th>
      <th>date_creation</th>
      <th>couleur</th>
      <th>prix</th>
      <th>classe</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>300.0</td>
      <td>3.0</td>
      <td>10/02/2010</td>
      <td>bleu</td>
      <td>100</td>
      <td>N</td>
    </tr>
    <tr>
      <th>1</th>
      <td>200.0</td>
      <td>2.0</td>
      <td>03/09/2012</td>
      <td>vert</td>
      <td>90</td>
      <td>N</td>
    </tr>
    <tr>
      <th>2</th>
      <td>250.0</td>
      <td>3.0</td>
      <td>21/08/2011</td>
      <td>bleu</td>
      <td>80</td>
      <td>N</td>
    </tr>
    <tr>
      <th>3</th>
      <td>280.0</td>
      <td>3.0</td>
      <td>21/08/2010</td>
      <td>bleu</td>
      <td>85</td>
      <td>N</td>
    </tr>
    <tr>
      <th>4</th>
      <td>200.0</td>
      <td>NaN</td>
      <td>01/10/2012</td>
      <td>bleu</td>
      <td>82</td>
      <td>N</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 11 entries, 0 to 10
Data columns (total 6 columns):
 #   Column         Non-Null Count  Dtype  
---  ------         --------------  -----  
 0   surface        10 non-null     float64
 1   nb_chambre     9 non-null      float64
 2   date_creation  11 non-null     object 
 3   couleur        11 non-null     object 
 4   prix           11 non-null     int64  
 5   classe         11 non-null     object 
dtypes: float64(2), int64(1), object(3)
memory usage: 656.0+ bytes
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,:</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;classe&quot;</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Example-of-our-TransformeeMaison-Class">Example of our TransformeeMaison Class<a class="anchor-link" href="#Example-of-our-TransformeeMaison-Class"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">trsf</span> <span class="o">=</span> <span class="n">TransformeeMaison</span><span class="p">(</span><span class="n">dateTo</span><span class="o">=</span><span class="s1">&#39;age&#39;</span><span class="p">)</span>
<span class="n">new_data</span> <span class="o">=</span> <span class="n">trsf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">new_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>surface</th>
      <th>nb_chambre</th>
      <th>age</th>
      <th>couleur_bleu</th>
      <th>couleur_vert</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>300.0</td>
      <td>3.0</td>
      <td>12</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>200.0</td>
      <td>2.0</td>
      <td>10</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>250.0</td>
      <td>3.0</td>
      <td>11</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>280.0</td>
      <td>3.0</td>
      <td>12</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>200.0</td>
      <td>4.0</td>
      <td>10</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Let's-apply-our-Pipeline-Pipy">Let's apply our Pipeline Pipy<a class="anchor-link" href="#Let's-apply-our-Pipeline-Pipy"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">X_train</span><span class="p">,</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_train</span><span class="p">,</span><span class="n">y_test</span> <span class="o">=</span> <span class="n">split_data</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">Pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
                 <span class="p">(</span><span class="s1">&#39;trsf&#39;</span><span class="p">,</span><span class="n">TransformeeMaison</span><span class="p">()),</span>
                 <span class="p">(</span><span class="s1">&#39;ss&#39;</span><span class="p">,</span><span class="n">StandardScaler</span><span class="p">()),</span>
                 <span class="p">(</span><span class="s1">&#39;pca&#39;</span><span class="p">,</span><span class="n">PCA</span><span class="p">()),</span>
                 <span class="p">(</span><span class="s1">&#39;svm&#39;</span><span class="p">,</span><span class="n">SVC</span><span class="p">())</span>
                <span class="p">])</span>
<span class="c1">##les params sont pour le gridsearch pour trouver la meilleur combinaison</span>
<span class="n">Params</span> <span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;trsf__dateTo&#39;</span><span class="p">:(</span><span class="s1">&#39;age&#39;</span><span class="p">,</span><span class="s1">&#39;annee&#39;</span><span class="p">),</span>
    <span class="s1">&#39;pca__n_components&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span>
    <span class="s1">&#39;svm__kernel&#39;</span><span class="p">:(</span><span class="s1">&#39;linear&#39;</span><span class="p">,</span><span class="s1">&#39;rbf&#39;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="initialisation-of-Pipy-Class">initialisation of Pipy Class<a class="anchor-link" href="#initialisation-of-Pipy-Class"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span> <span class="o">=</span><span class="n">Pipy</span><span class="p">(</span><span class="n">Pipe</span><span class="p">,</span><span class="n">Params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="searching-best-Params">searching best Params<a class="anchor-link" href="#searching-best-Params"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">gridSearchy</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>GridSearchCV(cv=3,
             estimator=Pipeline(steps=[(&#39;trsf&#39;, TransformeeMaison()),
                                       (&#39;ss&#39;, StandardScaler()), (&#39;pca&#39;, PCA()),
                                       (&#39;svm&#39;, SVC())]),
             n_jobs=-1,
             param_grid={&#39;pca__n_components&#39;: (2, 3),
                         &#39;svm__kernel&#39;: (&#39;linear&#39;, &#39;rbf&#39;),
                         &#39;trsf__dateTo&#39;: (&#39;age&#39;, &#39;annee&#39;)})</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">gridBestEstimator</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Pipeline(steps=[(&#39;trsf&#39;, TransformeeMaison(dateTo=&#39;age&#39;)),
                (&#39;ss&#39;, StandardScaler()), (&#39;pca&#39;, PCA(n_components=2)),
                (&#39;svm&#39;, SVC(kernel=&#39;linear&#39;))])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

